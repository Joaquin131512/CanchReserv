{% extends 'booking/base.html' %}

{% block title %}Mis Reservas - ReservaCancha{% endblock %}

{% block content %}
<div class="min-h-screen bg-background-light dark:bg-background-dark">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <h1 class="text-4xl font-bold text-[#0d1b12] dark:text-white mb-2">Mis Reservas</h1>
        <p class="text-gray-600 dark:text-gray-400 mb-8">Gestiona tus reservas de canchas deportivas</p>

        <!-- Tabs -->
        <div class="flex gap-4 border-b border-gray-200 dark:border-gray-700 mb-6">
            <a href="{% url 'mis_reservas' %}?tab=proximas" 
               class="px-4 py-2 font-medium {% if tab == 'proximas' or not tab %}text-primary border-b-2 border-primary{% else %}text-gray-600 dark:text-gray-400 hover:text-primary{% endif %}">
                PrÃ³ximas
            </a>
            <a href="{% url 'mis_reservas' %}?tab=historial"
               class="px-4 py-2 font-medium {% if tab == 'historial' %}text-primary border-b-2 border-primary{% else %}text-gray-600 dark:text-gray-400 hover:text-primary{% endif %}">
                Historial
            </a>
        </div>

        {% if tab == 'proximas' or not tab %}
            <!-- PrÃ³ximas Reservas -->
            {% if reservas_proximas %}
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    {% for reserva in reservas_proximas %}
                        <div class="bg-white dark:bg-[#182c1e] rounded-lg p-6 shadow-lg">
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <h3 class="text-lg font-bold text-[#0d1b12] dark:text-white">
                                        {{ reserva.cancha.nombre }}
                                    </h3>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">
                                        {{ reserva.cancha.get_tipo_display }}
                                    </p>
                                </div>
                                <span class="px-3 py-1 bg-primary/10 text-primary text-xs font-medium rounded">
                                    {{ reserva.get_estado_display }}
                                </span>
                            </div>

                            <div class="space-y-2 mb-4 text-sm text-gray-600 dark:text-gray-400">
                                <p>ğŸ“… {{ reserva.fecha|date:"d/m/Y" }}</p>
                                <p>ğŸ• {{ reserva.hora_inicio|time:"H:i" }} - {{ reserva.hora_fin|time:"H:i" }}</p>
                                <p>ğŸ“ {{ reserva.cancha.ubicacion }}</p>
                            </div>

                            <div class="border-t border-gray-200 dark:border-gray-700 pt-4 mb-4">
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-600 dark:text-gray-400">Total:</span>
                                    <span class="text-xl font-bold text-primary">${{ reserva.total }}</span>
                                </div>
                            </div>

                            <div class="flex gap-2">
                                <a href="{% url 'detalle_cancha' reserva.cancha.id %}" 
                                   class="flex-1 text-center px-3 py-2 bg-primary/10 text-primary rounded-lg hover:bg-primary/20 transition text-sm font-medium">
                                    Ver Cancha
                                </a>
                                <form method="POST" action="{% url 'cancelar_reserva' reserva.id %}" class="flex-1">
                                    {% csrf_token %}
                                    <button type="submit" onclick="return confirm('Â¿EstÃ¡s seguro de que deseas cancelar esta reserva?')"
                                            class="w-full px-3 py-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition text-sm font-medium">
                                        Cancelar
                                    </button>
                                </form>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="text-center py-12 bg-white dark:bg-[#182c1e] rounded-lg">
                    <p class="text-gray-600 dark:text-gray-400 text-lg mb-4">No tienes reservas prÃ³ximas</p>
                    <a href="{% url 'booking_home' %}" class="inline-block px-4 py-2 bg-primary text-[#0d1b12] rounded-lg font-medium hover:opacity-90">
                        Buscar Canchas
                    </a>
                </div>
            {% endif %}
        {% else %}
            <!-- Historial -->
            {% if reservas_historial %}
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    {% for reserva in reservas_historial %}
                        <div class="bg-white dark:bg-[#182c1e] rounded-lg p-6 shadow-lg opacity-75">
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <h3 class="text-lg font-bold text-[#0d1b12] dark:text-white">
                                        {{ reserva.cancha.nombre }}
                                    </h3>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">
                                        {{ reserva.cancha.get_tipo_display }}
                                    </p>
                                </div>
                                <span class="px-3 py-1 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 text-xs font-medium rounded">
                                    {{ reserva.get_estado_display }}
                                </span>
                            </div>

                            <div class="space-y-2 mb-4 text-sm text-gray-600 dark:text-gray-400">
                                <p>ğŸ“… {{ reserva.fecha|date:"d/m/Y" }}</p>
                                <p>ğŸ• {{ reserva.hora_inicio|time:"H:i" }} - {{ reserva.hora_fin|time:"H:i" }}</p>
                                <p>ğŸ“ {{ reserva.cancha.ubicacion }}</p>
                            </div>

                            <div class="border-t border-gray-200 dark:border-gray-700 pt-4">
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-600 dark:text-gray-400">Total:</span>
                                    <span class="text-xl font-bold text-primary">${{ reserva.total }}</span>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="text-center py-12 bg-white dark:bg-[#182c1e] rounded-lg">
                    <p class="text-gray-600 dark:text-gray-400 text-lg">No tienes historial de reservas</p>
                </div>
            {% endif %}
        {% endif %}
    </div>
</div>
{% endblock %}
      